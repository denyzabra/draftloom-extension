<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DraftLoom - Writing Assistant</title>
    <link rel="stylesheet" href="styles/design-system.css">
    <link rel="stylesheet" href="styles/shared.css">
    <link rel="stylesheet" href="styles/sidebar.css">
</head>
<body>
    <div id="sidebar-app">
        <header class="sidebar-header">
            <h1>DraftLoom</h1>
            <button id="close-sidebar" class="btn-icon">‚úï</button>
        </header>

        <!-- AI Status Badge -->
        <div id="ai-status-banner" class="ai-status-banner">
            <div class="status-content">
                <span class="status-icon">ü§ñ</span>
                <div class="status-text">
                    <span class="status-title" id="status-title">Loading...</span>
                    <span class="status-subtitle" id="status-subtitle"></span>
                </div>
            </div>
            <button id="status-action-btn" class="status-action-btn" style="display: none;">Setup Guide</button>
        </div>

        <!-- Privacy/FERPA Alert (dynamically shown) -->
        <div id="privacy-alert-container" style="display: none;"></div>

        <nav class="tabs">
            <button class="tab-btn active" data-tab="brainstorm">Brainstorm</button>
            <button class="tab-btn" data-tab="draft">Draft</button>
            <button class="tab-btn" data-tab="rewrite">Rewrite</button>
            <button class="tab-btn" data-tab="proofread">Proofread</button>
            <button class="tab-btn" data-tab="analyze">Analyze</button>
            <button class="tab-btn" data-tab="settings">Settings</button>
        </nav>

        <main class="sidebar-content">
            <!-- Brainstorm Tab -->
            <div id="brainstorm-tab" class="tab-content active">
                <h2>Essay Brainstorming</h2>

                <!-- Quick Examples -->
                <div class="sample-buttons">
                    <p class="text-sm text-secondary mb-2">üí° Try these examples:</p>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 12px;">
                        <button class="btn btn-secondary btn-sm load-sample" data-sample="social-media">Social Media Impact</button>
                        <button class="btn btn-secondary btn-sm load-sample" data-sample="climate-change">Climate Change</button>
                        <button class="btn btn-secondary btn-sm load-sample" data-sample="book-analysis">Book Analysis</button>
                        <button class="btn btn-secondary btn-sm load-sample" data-sample="lab-report">Lab Report</button>
                    </div>
                </div>

                <textarea id="prompt-input" placeholder="Paste your assignment prompt here..." rows="4"></textarea>
                <button id="analyze-prompt" class="btn btn-primary">Analyze Prompt</button>
                <div id="prompt-analysis" class="output-box"></div>
            </div>

            <!-- Draft Tab -->
            <div id="draft-tab" class="tab-content">
                <h2>Generate Draft</h2>

                <!-- Quick Examples -->
                <div class="sample-buttons">
                    <p class="text-sm text-secondary mb-2">üí° Try these examples:</p>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 12px;">
                        <button class="btn btn-secondary btn-sm load-draft-sample" data-sample="essay-outline">Essay Outline</button>
                        <button class="btn btn-secondary btn-sm load-draft-sample" data-sample="quick-notes">Quick Notes</button>
                    </div>
                </div>

                <textarea id="draft-input" placeholder="Your ideas and notes..." rows="4"></textarea>
                <button id="generate-draft" class="btn btn-primary">Generate Draft</button>
                <div id="draft-output" class="output-box"></div>
            </div>

            <!-- Rewrite Tab -->
            <div id="rewrite-tab" class="tab-content">
                <h2>Rewrite & Polish</h2>

                <!-- Quick Examples -->
                <div class="sample-buttons">
                    <p class="text-sm text-secondary mb-2">üí° Try this example:</p>
                    <button class="btn btn-secondary btn-sm load-rewrite-sample mb-2" data-sample="casual-text">Improve This Text</button>
                </div>

                <div class="control-group">
                    <label>Tone:</label>
                    <select id="tone-select">
                        <option value="academic">Academic</option>
                        <option value="professional">Professional</option>
                        <option value="casual">Casual</option>
                    </select>
                </div>
                <div class="control-group">
                    <label>Length:</label>
                    <select id="length-select">
                        <option value="expand">Expand</option>
                        <option value="concise">Make Concise</option>
                        <option value="maintain">Maintain</option>
                    </select>
                </div>
                <textarea id="rewrite-input" placeholder="Text to rewrite..." rows="4"></textarea>
                <button id="rewrite-text" class="btn btn-primary">Rewrite</button>
                <div id="rewrite-output" class="output-box"></div>
            </div>

            <!-- Proofread Tab -->
            <div id="proofread-tab" class="tab-content">
                <h2>Proofread</h2>

                <!-- Quick Examples -->
                <div class="sample-buttons">
                    <p class="text-sm text-secondary mb-2">üí° Try this example:</p>
                    <button class="btn btn-secondary btn-sm load-proofread-sample mb-2" data-sample="errors">Text with Errors</button>
                </div>

                <textarea id="proofread-input" placeholder="Paste text to proofread..." rows="4"></textarea>
                <button id="proofread-text" class="btn btn-primary">Check Grammar & Spelling</button>
                <div id="proofread-output" class="output-box">
                    <div id="corrections-list"></div>
                </div>
            </div>

            <!-- Analyze Page Tab -->
            <div id="analyze-tab" class="tab-content">
                <h2>Analyze Current Page</h2>
                <p class="info-text">Get insights about the current webpage including word count, headings, and editable areas.</p>
                <button id="analyze-page-btn" class="btn btn-primary">Analyze This Page</button>
                <div id="page-analysis-output" class="output-box"></div>
            </div>

            <!-- Settings Tab -->
            <div id="settings-tab" class="tab-content">
                <h2>Settings</h2>

                <div class="settings-section">
                    <h3>Chrome AI Status</h3>
                    <div id="api-status" class="api-status-container">
                        <p>Loading API status...</p>
                    </div>
                    <button id="refresh-api-status" class="btn btn-secondary">Refresh Status</button>
                </div>

                <div class="settings-section">
                    <h3>Privacy & Data</h3>
                    <p class="info-text">üîí <strong>100% On-Device Processing:</strong> All AI processing happens locally in your browser using Chrome's Built-in AI.</p>
                    <p class="info-text">‚úÖ <strong>FERPA Compliant:</strong> Student data never leaves your device. No cloud servers, no data collection.</p>
                    <p class="info-text">üìä When Chrome AI is unavailable, Demo Mode provides simulated responses for testing the UI.</p>
                    <div class="control-group">
                        <label>
                            <input type="checkbox" id="enable-cache" checked>
                            Enable response caching (faster responses)
                        </label>
                    </div>
                    <button id="clear-cache" class="btn btn-secondary">Clear Cache</button>
                </div>

                <div class="settings-section">
                    <h3>üõ°Ô∏è Privacy Protection Demo</h3>
                    <p class="info-text">DraftLoom automatically scans for sensitive student information (PII) before processing. Test it below:</p>

                    <div class="privacy-demo-section">
                        <div class="privacy-demo-title">
                            <span>üß™ Test Sample</span>
                        </div>
                        <p class="text-sm text-secondary mb-2">Click to load sample text with PII:</p>
                        <button id="load-pii-sample" class="btn btn-secondary btn-sm">Load Sample with PII</button>
                    </div>

                    <textarea
                        id="privacy-test-input"
                        placeholder="Type or paste text here to test privacy protection..."
                        rows="6"
                        style="width: 100%; padding: 12px; border: 2px solid var(--dl-gray-300); border-radius: 8px; font-family: inherit; font-size: 14px; margin-top: 12px; resize: vertical;"
                    ></textarea>

                    <button id="check-privacy-btn" class="btn btn-primary" style="margin-top: 12px; width: 100%;">üîç Check for PII</button>

                    <div id="privacy-test-result" style="margin-top: 16px;"></div>
                </div>

                <div class="settings-section">
                    <h3>About</h3>
                    <p class="info-text">DraftLoom v1.0.0</p>
                    <p class="info-text">FERPA-compliant AI writing assistant powered by Chrome's built-in AI.</p>
                    <a href="chrome://flags/#optimization-guide-on-device-model" target="_blank" class="btn btn-link">Chrome AI Settings</a>
                </div>
            </div>
        </main>

        <footer class="sidebar-footer">
            <small>All processing happens locally ‚Ä¢ No data stored online</small>
        </footer>
    </div>

    <script src="sidebar.js"></script>
</body>
</html>